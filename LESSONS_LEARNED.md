# 🚀 Fresh Bowl 프로젝트 개발 회고: 안정적인 서비스를 향한 여정

이번 프로젝트를 진행하면서 우리는 기능 구현을 넘어 **"어떻게 하면 버그 없는 안정적인 서비스를 배포할 수 있을까?"** 에 대해 깊이 고민하고 해결책을 적용했습니다. 그 과정에서 얻은 핵심적인 기술적 교훈들을 정리합니다.

## 1. "내 로컬에선 되는데?"의 함정 탈출 (Build Verification)
### 문제 상황
개발 서버(`npm run dev`)에서는 완벽하게 작동하던 코드가, 실제 배포를 위한 빌드(`npm run build`) 단계에서는 에러를 뿜어내는 경우가 있었습니다.
- **Strict Type Checking**: 개발 모드에선 관대했던 TypeScript가 빌드 때는 엄격하게 검사하여 `null` 가능성 등을 지적합니다.
- **Server/Client Component 구분**: `'use client'` 지시어가 누락된 컴포넌트가 빌드 타임에 발견되기도 합니다.

### 교훈 & 해결책
- **"배포 전 로컬 빌드는 필수"**: Vercel에 올리기 전에 로컬에서 반드시 `npm run build`를 통과시켜야 합니다.
- **방어적 코딩**: `image_url` 등이 `null`로 들어올 경우를 항상 대비하여 Fallback 처리(`image_url ?? default_image`)를 하는 것이 빌드 안정성을 높입니다.

## 2. 수동 테스트의 한계와 자동화의 구원 (Playwright E2E)
### 문제 상황
기능 하나를 수정할 때마다 '홈 → 메뉴 선택 → 장바구니 → 결제' 흐름을 매번 손으로 클릭하며 확인하는 것은 고통스럽고 비효율적이었습니다. 결국 사람의 피로도는 **"이건 건드린 거 없으니까 괜찮겠지"** 라는 안일함으로 이어져 `NaN` 가격 표시 같은 치명적 버그를 놓치게 만듭니다.

### 교훈 & 해결책
- **Playwright 도입**: 24시간 지치지 않는 로봇 테스트 요원을 고용했습니다.
- **Mocking의 미학**: 외부 결제 시스템이나 AI API처럼 비용이 들거나 불안정한 요소는 가짜 응답(Mocking)으로 대체하여 **테스트 속도**와 **안정성**을 모두 잡았습니다.
- **결과**: Auth, AI 추천, 결제 흐름 등 7개의 핵심 시나리오를 단 3초(병렬 실행 시) 만에 검증할 수 있게 되었습니다.

## 3. 통합 검증 파이프라인 구축 (`npm run verify`)
### 문제 상황
빌드도 돌려봐야 하고, 테스트도 돌려봐야 하는데 명령어 두 번 치기가 번거로워 가끔 하나를 빼먹습니다.

### 교훈 & 해결책
- **원클릭 검증**: `package.json`에 `verify` 스크립트를 추가했습니다.
  ```json
  "verify": "npm run build && npm run test:e2e"
  ```
- **효과**: 이 명령어 하나가 성공하면 배포 성공률은 100%에 가깝습니다. 이는 개발자에게 엄청난 **"심리적 안정감"**을 줍니다.

## 4. AI 기능 개발과 사용자 경험
### 교훈
- **속도 vs 지능**: 처음엔 똑똑한 `Claude 3.5 Sonnet`을 썼지만 응답이 느려 사용자 경험이 좋지 않았습니다. 추천 같은 간단한 작업은 빠릿한 `GPT-4o-mini`가 훨씬 만족도가 높다는 것을 확인하고 교체했습니다.
- **상세 이동 연결**: 추천만 해주고 끝나는 게 아니라, 바로 주문할 수 있는 **링크**를 제공하는 것이 서비스의 완결성을 높여줍니다.

## 5. 배포의 디테일
### 교훈
- **환경 변수의 타이밍**: Vercel에서 환경 변수를 추가/수정했다면 반드시 **Redeploy(재배포)** 해야 적용됩니다. 코드 수정이 없어도 배포를 다시 트리거해야 서버가 새 변수를 물고 뜹니다.


## 6. 놓치기 쉬운 사용자 경험: "딥 링킹(Deep Linking)"
### 문제 상황
사용자는 항상 메인 페이지에서 시작하지 않습니다. "비건 메뉴 보여줘"라며 링크를 공유받아 들어오거나, Footer에서 직접 특정 카테고리로 진입하기도 합니다. 우리는 **탭 클릭 동작**만 테스트하느라, **URL로 치고 들어왔을 때**의 상태 동기화를 놓쳤습니다.

### 교훈
- **초기 상태 검증**: E2E 테스트 시나리오에 '중간 페이지로 직접 진입(`page.goto("/menu?category=vegan")`)'하는 케이스를 반드시 포함해야 합니다.
- **URL은 진실의 원천**: 화면의 상태(State)는 가능한 한 URL Query Parameter와 동기화되어야 사용자에게 일관된 경험을 줍니다.

---

## ✅ 결론: "속도는 신뢰에서 나온다"
검증 과정(테스트, 빌드)이 있으면 개발 속도가 느려질 것 같지만, 실제로는 **"다시 수정할 일"**을 없애주기 때문에 전체 프로젝트 완성 속도는 훨씬 빨라집니다. 우리는 이제 두려움 없이 코드를 수정하고 배포할 수 있는 강력한 기반을 갖추게 되었습니다.
